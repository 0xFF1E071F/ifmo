ORG 210
NUMT:       WORD    0005    ;Количество тестов

ORG 008
RZS:       WORD    0010    ;Адрес начала массива промежуточных результатов

ORG 015
RZULT:      WORD    0000    ;Конечный результат   
TWORD1:     WORD    FACE    ;Первое тестовое слово    
TWORD2:     WORD    FADE    ;Второе тестовое слово
BUFF:       WORD    ?       ;Буфер для временного хранения данных при тестировании
NUL:        WORD    0000    ;Ячейка содержащая одни нули
FUL:        WORD    FFFF    ;Ячейка содержащая одни единицы
TW2ADR:     WORD    0017    ;Адрес второго тестового слова
COUNTR:     WORD    ?       ;Счетчик

ORG     020             ;Основная программа
BEGIN:  JSR CHK_C0      ;Проверка сохранения нулевого состояния бита С
	JSR CHK_C1      ;Проверка сброса бита С если он был установлен в единицу
	JSR VALNUL     ;Проверка логического умножения на нулевую ячейку
	JSR VALFUL     ;Проверка логического умножения на ячейку, в которой все единицы
	JSR VALCUR     ;Проверка логического умножения ячейки с использованием косвенной адресации
	JSR ALLOK      ;Выдача конечного результата тестирования
	HLT
                        ;Проверка сохранения нулеового состояния бита С
CHK_C0: WORD    ?       ;Адрес возврата
	CLA
        ADD	TWORD2
	MOV     BUFF
	CLA
        CMA
        AND     TWORD1
        WORD	7017
        BCS     WRT1      
        CLA
WRT1:   JSR      WRTRZS
	CLA
	ADD     BUFF
	MOV     TWORD2
	BR      (CHK_C0)   
        
                        ;Проверка сброса бита С если он был установлен в единицу
CHK_C1: WORD    ?       ;Адрес возврата
        CLA
        ADD	TWORD2
	MOV     BUFF
	CLA
	CMA
        AND     TWORD1
        ADD     TWORD2
        WORD    7017
        BCS     WRT2
        CLA
WRT2:   JSR      WRTRZS
	CLA
	ADD     BUFF
	MOV     TWORD2
        BR      (CHK_C1)   
        
                        ;Проверка логического умножения на нулевую ячейку
VALNUL: WORD    ?       ;Адрес возврата
        CLA
	ADD	TWORD1
	MOV	BUFF
	CLA
        WORD    7016
        CLA
        ADD     TWORD1
        JSR      WRTRZS
	CLA
	ADD     BUFF
	MOV	TWORD1
        BR      (VALNUL)
        
                        ;Проверка логического умножения на нулевую ячейку
VALFUL: WORD    ?       ;Адрес возврата
        CLA
	ADD     TWORD1
        MOV     BUFF
	CLA
	CMA
        WORD    7016
	CLA
        ADD     TWORD1
        SUB     BUFF     
        JSR      WRTRZS
	CLA
	ADD     BUFF
	MOV	TWORD1
        BR      (VALFUL)
        
                        ;Проверка логического умножения ячейки с использованием косвенной адресации
VALCUR: WORD    ?       ;Адрес возврата
        CLA
	ADD     TWORD1
	AND     (TW2ADR)
        MOV     BUFF
	CLA
        ADD     TWORD1
        WORD    781B
        CLA
        ADD     (TW2ADR)
        SUB     BUFF     
        JSR      WRTRZS
        BR      (VALCUR)

WRTRZS: WORD    ?       ;Запись успешности прохождения теста
	BEQ     NOERR   ;Если в аккумуляторе 0, то ошибки не возникло
        CLA
        MOV     (RZS)
        BR      (WRTRZS)
NOERR:  CLA
        INC
        MOV     (RZS)
        BR      (WRTRZS)
        
ALLOK:  WORD    ?       ;Запись успешности прохождения теста
        CLA
        SUB     NUMT
        MOV     COUNTR
        ADD     RZS
        MOV     RZS
	CLA
LOOP:   ADD     (RZS)
        ISZ     COUNTR
        BR      LOOP
	SUB     NUMT
        JSR      WRTRZS
        BR      (ALLOK)